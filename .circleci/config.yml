version: 2

jobs:
    test_beta:
        docker:
            - image: circleci/php:7.2.15

        steps:
            - checkout
            - run:
                name: "Composer Update & Dependency Installation"
                command: |
                    sudo composer self-update
                    sudo composer install
            - run:
                name: "Create '.env' File"
                command: >
                    echo "REST_URL=$REST_URL" >> .env &&
                    echo "REST_KEY=$REST_KEY" >> .env &&
                    cat .env
            - run:
                name: "Tests"
                command: echo $REST_URL && sudo vendor/bin/phpunit --configuration phpunit.xml --testsuite General




workflows:
    version: 2

    build_and_test:
        jobs:
            - test_beta:
                  context: ucrm.dev.mvqn.net